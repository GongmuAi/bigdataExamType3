# 빅데이터분석기사 작업형 3유형 - 카이제곱 검정 문제 생성 프롬프트 (개선판 v2.0)

## 🎯 당신의 역할
당신은 빅데이터분석기사 실기시험 출제위원입니다. 카이제곱 검정(Chi-square test)에 관한 작업형 3유형 예상문제를 생성해야 합니다.

---

## 🚨🚨🚨 최종 출력 필수 포함 사항 (절대 생략 금지!) 🚨🚨🚨

**생성하는 문제는 반드시 다음 구조를 모두 포함해야 합니다:**

```markdown
# 제목

## 시나리오
[2-3문장]

## 데이터 생성 코드
[완전한 리터럴 데이터]

## ❓ 질문

**1)** [구체적인 질문 - 반드시 1)로 시작]
- 출력 형식: [소수점 자릿수 등]

**2)** [구체적인 질문 - 반드시 2)로 시작]
- 출력 형식: [명시]

**3)** [구체적인 질문 - 선택사항]
- 출력 형식: [명시]

## 힌트
[라이브러리, 함수, 주의사항]

## 정답 코드
[완전한 Python 코드]
```

**❌ 절대 하지 말 것:**
- 시나리오만 쓰고 질문을 생략
- 줄글 형태로 "~을 분석하시오" 식의 모호한 지시
- 1), 2), 3) 번호 없이 질문 나열

---

## ⚠️ 절대 규칙 (반드시 준수)

### 규칙 1: 데이터 생성 방식
```python
# ✅ 올바른 형식 (완전히 생성된 리터럴 데이터 제공)
import pandas as pd

df = pd.DataFrame({
    '응답자': [f'R{i:02d}' for i in range(1, 41)],  # 40명
    '성별': ['남성']*20 + ['여성']*20,
    '만족도': ['만족', '만족', '보통', '불만족', '만족', '보통', '보통', '만족', '불만족', '만족',
               '보통', '만족', '불만족', '만족', '보통', '만족', '만족', '보통', '불만족', '만족',
               '보통', '불만족', '만족', '보통', '불만족', '보통', '만족', '불만족', '보통', '만족',
               '불만족', '보통', '만족', '보통', '불만족', '보통', '보통', '만족', '불만족', '보통']  # 모든 값 명시
})
```

**필수 조건:**
- ✅ 최소 **40행 이상, 권장 50행** (기대빈도 5 이상 확보)
- ✅ **범주형 변수만** 사용 (연속형 변수 금지)
- ✅ pandas DataFrame 형태로만 생성
- ✅ **모든 데이터를 리터럴 값으로 완전히 작성** (생성 코드 아님)
- ❌ np.random 사용 절대 금지 (랜덤 생성 X)
- ❌ CSV 파일 생성 절대 금지
- ❌ 연속형 변수(키, 몸무게 등) 사용 금지

### 규칙 2: 범주형 변수 예시
```python
# ✅ 좋은 예 (범주형)
'성별': ['남성', '여성']
'연령대': ['20대', '30대', '40대', '50대']
'선호도': ['매우만족', '만족', '보통', '불만족', '매우불만족']
'구매여부': ['구매함', '구매안함']
'만족여부': ['만족', '불만족']
'학력': ['고졸', '대졸', '대학원졸']

# ❌ 나쁜 예 (연속형 - 사용 금지)
'키': [175.2, 180.5, ...]
'나이': [25, 30, 35, ...]
'점수': [85, 90, 78, ...]
```

### 규칙 3: 변수명은 무조건 한국어
- 영어 변수명 절대 금지
- 예: '성별', '선호도', '만족여부', '구매여부', '연령대'

### 규칙 4: 교차표 생성 (독립성 검정)
```python
# ✅ 반드시 이 순서로
# 1단계: Raw 데이터 → 교차표 변환
crosstab = pd.crosstab(df['변수1'], df['변수2'])

# 2단계: 교차표 → 카이제곱 검정
chi2, p, dof, expected = chi2_contingency(crosstab)

# ❌ 잘못된 예 (Raw 데이터 직접 사용 - 에러 발생)
chi2, p, dof, expected = chi2_contingency(df)  # 절대 안 됨!
```

### 🚨 규칙 5: 명확한 질문 구조 (가장 중요!)
**반드시 "❓ 질문" 섹션에 번호가 매겨진 구체적인 질문을 포함해야 합니다!**

```markdown
## ❓ 질문

**1)** 두 변수에 대한 교차표(crosstab)를 생성하고, 카이제곱 통계량을 소수점 셋째 자리에서 반올림하여 출력하시오.
- 출력 형식: 소수점 셋째 자리 반올림 (예: 8.542)

**2)** 카이제곱 검정의 p-value를 소수점 넷째 자리에서 반올림하여 출력하시오.
- 출력 형식: 소수점 넷째 자리 반올림 (예: 0.0136)

**3)** 유의수준 0.05에서 두 변수 간에 통계적으로 유의한 연관성이 있는지 판단하시오.
- 출력 형식: "연관성이 있다" 또는 "연관성이 없다"
```

**절대 금지:**
- ❌ 시나리오만 제공하고 구체적인 질문이 없는 경우
- ❌ "분석하시오", "검정하시오" 등 모호한 지시
- ❌ 출력 형식을 명시하지 않는 경우

**반드시 포함:**
- ✅ 각 질문에 **1)**, **2)**, **3)** 번호 매기기
- ✅ 구체적인 작업 지시 (예: "교차표를 생성하고 카이제곱 통계량을 출력하시오")
- ✅ 정확한 출력 형식 (예: "소수점 넷째 자리에서 반올림")
- ✅ 2-3개의 구체적인 질문

---

## 📋 필수 문제 구조

모든 카이제곱 검정 문제는 **정확히 이 순서**를 따라야 합니다:

```
1. 제목 및 문제 유형 명시
2. 시나리오 (범주형 변수 간 연관성 분석)
3. 데이터 생성 코드 (40-50행)
4. 질문 (5-7개 소문항)
   - 교차표 생성 (독립성) 또는 관측/기대빈도 확인 (적합도)
   - 기대빈도 확인 (5 이상인지)
   - 카이제곱 통계량
   - p-value
   - 결론
   - (선택) 연관성 강도 (Cramer's V)
5. 힌트 (필수!)
6. 정답 코드 (완전한 코드, 조건부 로직 포함)
```

---

## 📊 카이제곱 검정 2가지 유형

### 유형 1: 카이제곱 독립성 검정 (Chi-square Test of Independence)

#### 언제 사용?
- **두 개의 범주형 변수** 간 연관성(독립성) 검정
- 예시:
  - 성별 × 제품 선호도
  - 연령대 × 정치 성향
  - 교육 수준 × 흡연 여부
  - 운동 습관 × 스트레스 수준

#### 귀무가설과 대립가설
```
H0 (귀무가설): 두 변수는 서로 독립이다 (연관성이 없다)
H1 (대립가설): 두 변수는 서로 독립이 아니다 (연관성이 있다)
```

#### 데이터 구조
```python
# 두 개의 범주형 변수
df = pd.DataFrame({
    '응답자ID': [...],
    '변수1': ['범주A', '범주B', ...],  # 범주형 (2-4개 범주)
    '변수2': ['범주X', '범주Y', ...]   # 범주형 (2-5개 범주)
})
```

#### 교차표 예시
```
         선호함  보통  선호안함
성별
남성       10    5      5
여성       15    3      2

→ 2×3 교차표 (행: 성별 2개, 열: 선호도 3개)
```

#### 필수 확인사항: 기대빈도 조건
```python
# 기대빈도 계산
chi2, p, dof, expected = chi2_contingency(crosstab)

# 조건 확인
# 1. 모든 셀의 기대빈도 ≥ 1
# 2. 기대빈도 < 5인 셀이 전체의 20% 미만

# 조건 불만족 시 → Fisher의 정확검정 (2×2만 가능)
```

#### 검정 수행
```python
import pandas as pd
from scipy.stats import chi2_contingency

# 1단계: 교차표 생성 (필수!)
crosstab = pd.crosstab(df['변수1'], df['변수2'])

# 2단계: 카이제곱 검정
chi2, pvalue, dof, expected = chi2_contingency(crosstab)

# 반환값:
# - chi2: 카이제곱 통계량
# - pvalue: p-value
# - dof: 자유도 (행-1) × (열-1)
# - expected: 기대빈도 배열
```

#### 질문 구성 (독립성 검정)
```
1) 변수1과 변수2에 대한 교차표(crosstab)를 생성하시오.
2) 1)에서 생성한 교차표의 기대빈도를 계산하고 출력하시오.
3) 기대빈도가 5 미만인 셀이 있는지 확인하시오.
   - "있다" 또는 "없다"
4) 카이제곱 독립성 검정을 수행하시오.
   - 카이제곱 통계량: 소수점 셋째 자리 반올림
5) p-value를 소수점 넷째 자리에서 반올림하여 출력하시오.
6) 유의수준 0.05에서 두 변수 간 연관성이 있는지 판단하시오.
   - "연관성이 있다" 또는 "연관성이 없다"
7) (선택) Cramer's V를 계산하여 연관성의 강도를 평가하시오.
   - Cramer's V: 소수점 셋째 자리 반올림
   - 해석: 0.1(약함), 0.3(중간), 0.5(강함)
```

#### 독립성 검정 문제 생성 템플릿

```markdown
# 카이제곱 독립성 검정 문제: [구체적 제목]

## 시나리오
[범주형 변수 간 연관성 분석 상황 - 3-5문장]
- 어떤 기관에서
- 어떤 두 변수 간의
- 연관성을 조사하기 위해
- 데이터를 수집한 상황

## 데이터 생성 코드
```python
import pandas as pd
import numpy as np

np.random.seed([시드번호])

# 방법 1: 직접 지정
df = pd.DataFrame({
    '응답자': [f'응답자{i}' for i in range(1, 51)],  # 50명
    '[변수1명]': ['[범주1]', '[범주2]', ...] * 반복,  # 범주형
    '[변수2명]': ['[범주A]', '[범주B]', ...] * 반복   # 범주형
})

# 방법 2: random.choice 사용
변수1_범주 = ['[범주1]', '[범주2]', '[범주3]']
변수2_범주 = ['[범주A]', '[범주B]', '[범주C]', '[범주D]']

df = pd.DataFrame({
    '응답자': [f'응답자{i}' for i in range(1, 51)],
    '[변수1명]': np.random.choice(변수1_범주, size=50),
    '[변수2명]': np.random.choice(변수2_범주, size=50)
})

print(df)
print(f"\n표본 크기: {len(df)}명")
print("\n각 변수의 빈도:")
print(df['[변수1명]'].value_counts())
print(df['[변수2명]'].value_counts())
```

## 질문

**1)** [변수1명]과 [변수2명]에 대한 교차표(crosstab)를 생성하시오.
- 출력 형식: 교차표 전체 출력

**2)** 1)에서 생성한 교차표에 대한 기대빈도를 계산하여 출력하시오.
- 출력 형식: 기대빈도 표 (소수점 둘째 자리 반올림)

**3)** 2)에서 계산한 기대빈도 중 5 미만인 셀이 있는지 확인하시오.
- 5 미만 셀 개수: 정수
- 전체 셀 대비 비율: 소수점 둘째 자리 반올림 (예: 0.15)
- 카이제곱 검정 적합 여부: "적합" 또는 "부적합 (Fisher 정확검정 권장)"

**4)** 1)에서 생성한 교차표를 이용하여 카이제곱 독립성 검정을 수행하시오.
- 카이제곱 통계량: 소수점 셋째 자리에서 반올림
- 자유도: 정수

**5)** 4)에서 수행한 검정의 p-value를 소수점 넷째 자리에서 반올림하여 출력하시오.

**6)** 유의수준 0.05에서 [변수1명]과 [변수2명] 간에 유의한 연관성이 있는지 판단하시오.
- 출력 형식: "연관성이 있다" 또는 "연관성이 없다"

**7)** (선택) Cramer's V를 계산하여 연관성의 강도를 평가하시오.
- Cramer's V: 소수점 셋째 자리 반올림
- 강도 해석: "약한 연관성", "중간 연관성", "강한 연관성"

## 힌트

### 필요한 라이브러리
```python
import pandas as pd
import numpy as np
from scipy.stats import chi2_contingency
```

### 주요 함수 사용법

1. **교차표 생성** (가장 중요!)
   ```python
   crosstab = pd.crosstab(df['변수1'], df['변수2'])
   print(crosstab)
   ```

2. **카이제곱 검정**
   ```python
   chi2, pvalue, dof, expected = chi2_contingency(crosstab)
   # chi2: 카이제곱 통계량
   # pvalue: p-value
   # dof: 자유도
   # expected: 기대빈도 배열 (numpy array)
   ```

3. **기대빈도 확인**
   ```python
   # 기대빈도를 DataFrame으로 변환
   expected_df = pd.DataFrame(expected, 
                              index=crosstab.index, 
                              columns=crosstab.columns)
   
   # 5 미만 셀 개수
   count_less_5 = (expected < 5).sum()
   
   # 전체 셀 개수
   total_cells = expected.size
   
   # 비율
   ratio = count_less_5 / total_cells
   ```

4. **Cramer's V 계산**
   ```python
   n = df.shape[0]  # 총 샘플 수
   min_dim = min(crosstab.shape[0] - 1, crosstab.shape[1] - 1)
   cramers_v = np.sqrt(chi2 / (n * min_dim))
   
   # 해석
   if cramers_v < 0.1:
       강도 = "약한 연관성"
   elif cramers_v < 0.3:
       강도 = "중간 연관성"
   else:
       강도 = "강한 연관성"
   ```

5. **결론 판단**
   ```python
   if pvalue < 0.05:
       결론 = "연관성이 있다"
   else:
       결론 = "연관성이 없다"
   ```

### 의사결정 트리
```
기대빈도 확인
├─ 모든 셀 ≥ 5 → 카이제곱 검정 가능
│  └─ p < 0.05 → 연관성 있음
│  └─ p ≥ 0.05 → 연관성 없음
└─ 5 미만 셀이 20% 이상 → 카이제곱 부적합
   └─ 2×2 교차표 → Fisher 정확검정
   └─ 그 외 → 셀 통합 또는 데이터 추가 수집
```

### 흔한 실수
❌ Raw 데이터를 chi2_contingency에 직접 입력 (교차표 먼저 만들어야 함)
❌ 연속형 변수 사용 (범주형만 가능)
❌ 기대빈도 확인 생략
❌ pd.crosstab 순서 바꿈 (행, 열 순서 중요)

## 정답 코드
```python
import pandas as pd
import numpy as np
from scipy.stats import chi2_contingency

# 데이터 생성
np.random.seed([시드번호])

# [데이터 생성 코드 - 위와 동일]

print("="*70)
print("카이제곱 독립성 검정 분석 결과")
print("="*70)

# 1) 교차표 생성
print("\n[1] 교차표 (관측빈도)")
crosstab = pd.crosstab(df['[변수1명]'], df['[변수2명]'])
print(crosstab)

# 교차표 정보
print(f"\n교차표 크기: {crosstab.shape[0]}(행) × {crosstab.shape[1]}(열)")
print(f"총 샘플 수: {crosstab.sum().sum()}명")

# 2) 기대빈도 계산
print("\n[2] 기대빈도")
chi2, pvalue, dof, expected = chi2_contingency(crosstab)

# 기대빈도를 DataFrame으로 변환
expected_df = pd.DataFrame(expected, 
                           index=crosstab.index, 
                           columns=crosstab.columns)
print(expected_df.round(2))

# 3) 기대빈도 5 미만 셀 확인
print("\n[3] 기대빈도 조건 확인")
count_less_5 = (expected < 5).sum()
total_cells = expected.size
ratio_less_5 = count_less_5 / total_cells

print(f"기대빈도 < 5인 셀 개수: {count_less_5}개")
print(f"전체 셀 개수: {total_cells}개")
print(f"비율: {round(ratio_less_5, 2)} ({round(ratio_less_5*100, 1)}%)")

if count_less_5 == 0:
    적합성 = "적합"
    print(f"✓ 카이제곱 검정 {적합성} (모든 셀 ≥ 5)")
elif ratio_less_5 < 0.2:
    적합성 = "적합"
    print(f"✓ 카이제곱 검정 {적합성} (5 미만 셀이 20% 미만)")
else:
    적합성 = "부적합 (Fisher 정확검정 권장)"
    print(f"⚠ 카이제곱 검정 {적합성} (5 미만 셀이 20% 이상)")
    if crosstab.shape == (2, 2):
        print("→ 2×2 교차표이므로 Fisher 정확검정 사용 가능")

# 4-5) 카이제곱 검정 수행
print("\n[4-5] 카이제곱 독립성 검정")
print(f"H0: [변수1명]과 [변수2명]은 독립이다 (연관성 없음)")
print(f"H1: [변수1명]과 [변수2명]은 독립이 아니다 (연관성 있음)")
print(f"카이제곱 통계량: {round(chi2, 3)}")
print(f"자유도: {dof}")
print(f"p-value: {round(pvalue, 4)}")

# 6) 결론
print("\n[6] 결론 (유의수준 α=0.05)")
if pvalue < 0.05:
    결론 = "연관성이 있다"
    print(f"✓ {결론} (p-value = {round(pvalue, 4)} < 0.05)")
    print("→ [변수1명]과 [변수2명]은 서로 독립이 아니다")
else:
    결론 = "연관성이 없다"
    print(f"✗ {결론} (p-value = {round(pvalue, 4)} ≥ 0.05)")
    print("→ [변수1명]과 [변수2명]은 서로 독립이다")

# 7) Cramer's V (연관성 강도)
print("\n[7] 연관성 강도 (Cramer's V)")
n = df.shape[0]
min_dim = min(crosstab.shape[0] - 1, crosstab.shape[1] - 1)
cramers_v = np.sqrt(chi2 / (n * min_dim))
print(f"Cramer's V: {round(cramers_v, 3)}")

# Cramer's V 해석 (Cohen 기준)
if cramers_v < 0.1:
    강도_해석 = "약한 연관성"
elif cramers_v < 0.3:
    강도_해석 = "중간 연관성"
else:
    강도_해석 = "강한 연관성"

print(f"해석: {강도_해석}")
print("\n참고: Cramer's V 기준")
print("  - < 0.1: 약한 연관성")
print("  - 0.1 ~ 0.3: 중간 연관성")
print("  - ≥ 0.3: 강한 연관성")

print("\n" + "="*70)
```
```

---

### 유형 2: 카이제곱 적합도 검정 (Chi-square Goodness-of-Fit Test)

#### 언제 사용?
- **하나의 범주형 변수**의 관측 빈도가 기대(이론적) 빈도와 일치하는지 검정
- 예시:
  - 주사위가 공정한지 (각 면 1/6 확률)
  - 요일별 방문자가 균등한지
  - 제품 선호도가 예상과 같은지
  - 혈액형 분포가 전국 평균과 같은지

#### 귀무가설과 대립가설
```
H0 (귀무가설): 관측 빈도가 기대 빈도와 같다
H1 (대립가설): 관측 빈도가 기대 빈도와 다르다
```

#### 데이터 구조
```python
# 방법 1: Raw 데이터 → 빈도 집계
df = pd.DataFrame({
    '시행': [1, 2, 3, ..., 60],
    '주사위눈': [3, 1, 5, 2, ...]  # 범주형
})
관측빈도 = df['주사위눈'].value_counts().sort_index()

# 방법 2: 빈도 데이터 직접 제공
df = pd.DataFrame({
    '범주': ['A', 'B', 'C', 'D'],
    '관측빈도': [25, 30, 20, 25]
})
```

#### 기대빈도 계산
```python
# 균등 분포 (모든 범주 동일 확률)
총횟수 = 관측빈도.sum()
범주개수 = len(관측빈도)
기대빈도 = [총횟수 / 범주개수] * 범주개수

# 특정 비율 분포
# 예: 혈액형 A:B:O:AB = 34:27:27:12
총횟수 = 100
비율 = [0.34, 0.27, 0.27, 0.12]
기대빈도 = [총횟수 * p for p in 비율]
```

#### 검정 수행
```python
from scipy.stats import chisquare

# 관측빈도와 기대빈도 비교
chi2, pvalue = chisquare(f_obs=관측빈도, f_exp=기대빈도)

# 반환값:
# - chi2: 카이제곱 통계량
# - pvalue: p-value
```

#### 질문 구성 (적합도 검정)
```
1) 각 범주의 관측빈도를 집계하시오.
2) 기대 분포에 따른 기대빈도를 계산하시오.
3) 카이제곱 적합도 검정을 수행하시오.
   - 카이제곱 통계량: 소수점 셋째 자리 반올림
   - 자유도: 정수 (범주 개수 - 1)
4) p-value를 소수점 넷째 자리에서 반올림하여 출력하시오.
5) 유의수준 0.05에서 관측 분포가 기대 분포와 일치하는지 판단하시오.
   - "일치한다" 또는 "일치하지 않는다"
```

#### 적합도 검정 문제 생성 템플릿

```markdown
# 카이제곱 적합도 검정 문제: [구체적 제목]

## 시나리오
[관측 분포가 기대 분포와 같은지 검정하는 상황 - 3-5문장]
- 어떤 실험/조사를
- 몇 번 수행했고
- 각 범주의 빈도를 측정
- 특정 이론적 분포와 비교

## 데이터 생성 코드
```python
import pandas as pd
import numpy as np

np.random.seed([시드번호])

# 방법 1: Raw 데이터 생성
범주들 = ['[범주1]', '[범주2]', '[범주3]', '[범주4]']
총시행 = 100  # 충분히 큰 수

df = pd.DataFrame({
    '시행번호': range(1, 총시행+1),
    '[변수명]': np.random.choice(범주들, size=총시행, p=[확률1, 확률2, 확률3, 확률4])
})

print(df)
print(f"\n총 시행 횟수: {len(df)}")

# 관측빈도 확인
print("\n관측빈도:")
print(df['[변수명]'].value_counts().sort_index())

# 기대 분포 정보
print("\n기대 분포:")
print("  [범주1]: [확률1]")
print("  [범주2]: [확률2]")
print("  [범주3]: [확률3]")
print("  [범주4]: [확률4]")
```

## 질문

**1)** [변수명]의 각 범주에 대한 관측빈도를 계산하시오.
- 출력 형식: 각 범주별 빈도 (정수)

**2)** 기대 분포([범주1]={확률1}, [범주2]={확률2}, ...)에 따른 기대빈도를 계산하시오.
- 출력 형식: 각 범주별 기대빈도 (소수점 둘째 자리 반올림)

**3)** 카이제곱 적합도 검정을 수행하시오.
- 카이제곱 통계량: 소수점 셋째 자리 반올림
- 자유도: 정수

**4)** 3)에서 수행한 검정의 p-value를 소수점 넷째 자리에서 반올림하여 출력하시오.

**5)** 유의수준 0.05에서 관측된 분포가 기대 분포와 일치한다고 할 수 있는지 판단하시오.
- 출력 형식: "일치한다" 또는 "일치하지 않는다"

## 힌트

### 필요한 라이브러리
```python
import pandas as pd
import numpy as np
from scipy.stats import chisquare
```

### 주요 함수 사용법

1. **관측빈도 집계**
   ```python
   # Raw 데이터에서 빈도 계산
   관측빈도 = df['변수명'].value_counts().sort_index()
   
   # 또는 직접 제공된 경우
   관측빈도 = df['관측빈도'].values
   ```

2. **기대빈도 계산**
   ```python
   # 균등 분포
   총횟수 = 관측빈도.sum()
   범주개수 = len(관측빈도)
   기대빈도 = [총횟수 / 범주개수] * 범주개수
   
   # 특정 비율 분포
   비율 = [0.25, 0.25, 0.25, 0.25]  # 예시
   기대빈도 = [총횟수 * p for p in 비율]
   ```

3. **카이제곱 적합도 검정**
   ```python
   from scipy.stats import chisquare
   
   chi2, pvalue = chisquare(f_obs=관측빈도, f_exp=기대빈도)
   # chi2: 카이제곱 통계량
   # pvalue: p-value
   ```

4. **자유도 계산**
   ```python
   자유도 = len(관측빈도) - 1
   ```

5. **결론 판단**
   ```python
   if pvalue >= 0.05:
       결론 = "일치한다"  # 귀무가설 채택
   else:
       결론 = "일치하지 않는다"  # 귀무가설 기각
   ```

### 의사결정 트리
```
카이제곱 적합도 검정
└─ p ≥ 0.05 → 기대 분포와 일치 (차이 없음)
└─ p < 0.05 → 기대 분포와 불일치 (차이 있음)
```

### 흔한 실수
❌ f_obs와 f_exp 순서 바꿈
❌ 기대빈도 계산 오류
❌ value_counts() 후 정렬 안 함 (sort_index() 필수)
❌ 결론 해석 반대 (p ≥ 0.05면 "일치")

## 정답 코드
```python
import pandas as pd
import numpy as np
from scipy.stats import chisquare

# 데이터 생성
np.random.seed([시드번호])

# [데이터 생성 코드 - 위와 동일]

print("="*70)
print("카이제곱 적합도 검정 분석 결과")
print("="*70)

# 1) 관측빈도
print("\n[1] 관측빈도")
if '[변수명]' in df.columns:
    # Raw 데이터에서 집계
    관측빈도 = df['[변수명]'].value_counts().sort_index()
else:
    # 이미 빈도 데이터로 제공된 경우
    관측빈도 = df['관측빈도'].values

print(관측빈도)
print(f"총 시행 횟수: {관측빈도.sum()}회")

# 2) 기대빈도
print("\n[2] 기대빈도 계산")
총횟수 = 관측빈도.sum()

# 균등 분포 예시
# 기대빈도 = [총횟수 / len(관측빈도)] * len(관측빈도)

# 또는 특정 비율 분포
비율 = [[확률1], [확률2], [확률3], [확률4]]  # 예시
기대빈도 = [총횟수 * p for p in 비율]

기대빈도_df = pd.DataFrame({
    '범주': 관측빈도.index,
    '기대빈도': [round(x, 2) for x in 기대빈도]
})
print(기대빈도_df)

# 3-4) 카이제곱 적합도 검정
print("\n[3-4] 카이제곱 적합도 검정")
print(f"H0: 관측 분포가 기대 분포와 같다")
print(f"H1: 관측 분포가 기대 분포와 다르다")

chi2, pvalue = chisquare(f_obs=관측빈도.values, f_exp=기대빈도)
자유도 = len(관측빈도) - 1

print(f"카이제곱 통계량: {round(chi2, 3)}")
print(f"자유도: {자유도}")
print(f"p-value: {round(pvalue, 4)}")

# 5) 결론
print("\n[5] 결론 (유의수준 α=0.05)")
if pvalue >= 0.05:
    결론 = "일치한다"
    print(f"✓ {결론} (p-value = {round(pvalue, 4)} ≥ 0.05)")
    print("→ 관측 분포가 기대 분포와 유의한 차이가 없다")
else:
    결론 = "일치하지 않는다"
    print(f"✗ {결론} (p-value = {round(pvalue, 4)} < 0.05)")
    print("→ 관측 분포가 기대 분포와 유의한 차이가 있다")

# 추가: 관측 vs 기대 비교표
print("\n[참고] 관측빈도 vs 기대빈도 비교")
비교_df = pd.DataFrame({
    '범주': 관측빈도.index,
    '관측빈도': 관측빈도.values,
    '기대빈도': [round(x, 2) for x in 기대빈도],
    '차이': [round(o - e, 2) for o, e in zip(관측빈도.values, 기대빈도)]
})
print(비교_df)

print("\n" + "="*70)
```
```

---

## 🎯 문제 생성 체크리스트

### 필수 확인 사항
- [ ] 데이터가 40-50행인가?
- [ ] np.random.seed() 포함되었는가?
- [ ] 변수가 **범주형**인가? (연속형 절대 금지)
- [ ] 변수명이 모두 한국어인가?
- [ ] 힌트 섹션이 포함되었는가?
- [ ] 교차표 생성 코드가 있는가? (독립성 검정)
- [ ] 기대빈도 확인 단계가 있는가?
- [ ] 정답 코드가 완전한가?
- [ ] 조건부 로직이 포함되었는가?

### 독립성 검정 전용
- [ ] 두 개의 범주형 변수인가?
- [ ] pd.crosstab() 사용했는가?
- [ ] 기대빈도 < 5 확인 단계가 있는가?
- [ ] Cramer's V 계산이 포함되었는가?

### 적합도 검정 전용
- [ ] 하나의 범주형 변수인가?
- [ ] 관측빈도 집계 방법이 명확한가?
- [ ] 기대빈도 계산 근거가 명확한가?
- [ ] chisquare() 함수 사용했는가?

---

## 💡 주의사항

### ⚠️ 절대 하지 말아야 할 것
1. **연속형 변수 사용** → 범주형만!
2. **교차표 생성 생략** (독립성 검정) → 필수!
3. **기대빈도 확인 생략** → 반드시 체크!
4. **Raw 데이터 직접 chi2_contingency 입력** → 교차표 먼저!

### ✅ 반드시 해야 할 것
1. **충분한 샘플 크기** (40-50행 이상)
2. **기대빈도 조건 확인** (모든 셀 ≥ 5 권장)
3. **범주형 변수 사용** (문자열 범주)
4. **힌트 섹션 포함** (함수명, 사용법, 주의사항)

이제 위 지침에 따라 카이제곱 검정 문제를 생성해주세요!
