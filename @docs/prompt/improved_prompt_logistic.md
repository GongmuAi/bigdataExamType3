# 빅데이터분석기사 작업형 3유형 - 로지스틱회귀분석 문제 생성 프롬프트

## 🚨🚨🚨 [최우선] 질문 형식 - 반드시 이 형식을 따르세요! 🚨🚨🚨

**생성할 문제의 질문 섹션은 반드시 다음 형식이어야 합니다:**

```
## ❓ 질문

Q1. [첫 번째 구체적인 질문] (출력: 소수점 X자리)
Q2. [두 번째 구체적인 질문] (출력: 소수점 X자리)
Q3. [세 번째 구체적인 질문] (출력: 소수점 X자리)
Q4. [네 번째 구체적인 질문] (출력: 예/아니오)
Q5. [다섯 번째 구체적인 질문] (출력: 소수점 X자리)
```

**⛔ 절대 금지:**
- ❌ **1)**, **2)**, **3)** 형식 사용 금지
- ❌ "## 질문" (이모지 없이) 사용 금지 → 반드시 "## ❓ 질문"
- ❌ "회귀분석 하시오", "모델을 만드시오" 같은 모호한 표현
- ❌ 출력 형식 명시 없이 질문만 작성

**✅ 반드시 포함:**
- ✅ "## ❓ 질문" 헤더 (이모지 포함)
- ✅ Q1. Q2. Q3. Q4. Q5. 형식 (최소 4개, 최대 7개)
- ✅ 각 질문 끝에 (출력: 소수점 X자리) 형식 명시
- ✅ 한 줄에 하나의 질문

---

## 📋 문제 구조 (순서 엄수)

모든 문제는 정확히 이 순서를 따라야 합니다:

```
# [제목]

## 시나리오
[이진 분류 문제 상황: 합격/불합격, 구매/비구매 등 2-3문장]

## 데이터 생성 코드
```python
[30-50행의 완전한 리터럴 데이터, 1개 이진 종속변수 + 2-4개 독립변수]
```

## ❓ 질문

Q1. [질문] (출력: 소수점 X자리)
Q2. [질문] (출력: 소수점 X자리)
Q3. [질문] (출력: 예/아니오)
...

## 힌트
[라이브러리, 함수, 주의사항]

## 정답 코드
```python
[완전한 Python 코드]
```
```

---

## ⚙️ 데이터 생성 규칙

### 필수 조건
- ✅ 30-50행 데이터
- ✅ **종속변수 1개** (이진 변수, 0/1 - 합격/불합격, 구매/비구매 등)
- ✅ **독립변수 2-4개** (연속형 또는 범주형)
- ✅ pandas DataFrame으로만 생성
- ✅ **완전한 리터럴 값** (np.random 사용 절대 금지)
- ✅ 변수명은 **무조건 한국어**
- ❌ CSV 파일 생성 금지
- ❌ 외부 파일 읽기 금지

### 올바른 예시
```python
import pandas as pd

df = pd.DataFrame({
    '고객ID': [f'C{i:03d}' for i in range(1, 41)],
    '나이': [25, 30, 35, 40, 28, 33, 38, 26, 31, 36,
             24, 29, 34, 39, 27, 32, 37, 25, 30, 35,
             23, 28, 33, 38, 26, 31, 36, 24, 29, 34,
             22, 27, 32, 37, 25, 30, 35, 23, 28, 33],
    '소득': [3500, 4200, 5000, 5500, 3800, 4500, 5200, 3600, 4300, 5100,
             3400, 4100, 4900, 5400, 3700, 4400, 5100, 3500, 4200, 5000,
             3300, 4000, 4800, 5300, 3600, 4300, 5000, 3400, 4100, 4900,
             3200, 3900, 4700, 5200, 3500, 4200, 4900, 3300, 4000, 4800],
    '방문횟수': [2, 5, 7, 10, 3, 6, 8, 2, 5, 7,
                 1, 4, 6, 9, 3, 5, 7, 2, 5, 7,
                 1, 4, 6, 9, 2, 5, 7, 1, 4, 6,
                 0, 3, 5, 8, 2, 5, 7, 1, 4, 6],
    '구매여부': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 1, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 0, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 0, 1, 1, 0, 1, 1, 0, 0, 1]  # 0: 비구매, 1: 구매
})
```

---

## 📊 로지스틱회귀 개념

### 언제 사용하는가?
- **이진 분류 문제**에서 확률을 예측할 때
- 종속변수가 **0 또는 1** (합격/불합격, 구매/비구매, 생존/사망)
- 예: 나이, 소득, 방문횟수로 구매 확률 예측
- 목적: **각 변수의 영향력 파악 (추론)** 또는 **이진 결과 예측 (분류)**

### 회귀식
```
log(p / (1-p)) = β₀ + β₁X₁ + β₂X₂ + β₃X₃

p: Y=1일 확률 (구매할 확률)
1-p: Y=0일 확률 (구매 안 할 확률)
p/(1-p): 오즈 (Odds)
β₁, β₂, β₃: 로그 오즈 회귀계수
```

### 핵심 개념

**1. 로그 오즈 회귀계수 (Log Odds Coefficient)**
- `model.params['변수명']`로 추출
- 해석하기 어려우므로 **오즈비로 변환** 필요

**2. 오즈비 (Odds Ratio)**
- `np.exp(model.params['변수명'])`로 계산
- **해석:**
  - 오즈비 > 1: 변수 1단위 증가 시 Y=1 확률 **증가**
  - 오즈비 = 1: 변수가 Y와 **무관**
  - 오즈비 < 1: 변수 1단위 증가 시 Y=1 확률 **감소**
- 예: 오즈비 = 1.5 → 변수 1단위 증가 시 Y=1 오즈가 1.5배 증가

**3. 예측 확률**
- `model.predict(새로운X)`로 계산
- 0~1 사이 값 (확률)
- 예: 0.75 → 구매할 확률 75%

**4. p-value (유의확률)**
- 변수가 통계적으로 유의한지 판단
- p < 0.05 → 유의함 (해당 변수가 Y에 영향을 줌)
- p ≥ 0.05 → 유의하지 않음 (영향 없음)

---

## 💻 Python 구현 (statsmodels)

### 필수: sm.add_constant() 사용!

```python
import pandas as pd
import numpy as np
import statsmodels.api as sm

# 데이터 준비
df = pd.DataFrame({...})

# X, y 분리
X = df[['나이', '소득', '방문횟수']]
y = df['구매여부']

# ⚠️ 절편 추가 (필수!)
X = sm.add_constant(X)

# Logit 모델 적합
model = sm.Logit(y, X).fit()

# 주요 결과
model.summary()                    # 전체 요약
model.params                       # 로그 오즈 회귀계수
np.exp(model.params)              # 오즈비
model.pvalues                      # p-value
model.predict(새로운X)             # 예측 확률 (0~1)
```

### 주의: sklearn의 LogisticRegression()과의 차이

**statsmodels (Logit)** - 추론용, 빅분기 시험 출제
- `sm.add_constant()` 필요
- `model.params`, `model.pvalues` 제공
- 오즈비 계산 가능 (`np.exp(model.params)`)
- 통계적 추론에 적합

**sklearn (LogisticRegression)** - 예측용
- 자동으로 절편 추가
- `model.coef_`, `model.intercept_` 제공
- 머신러닝 파이프라인에 적합

---

## 💡 질문 구성 패턴

### 기본 질문 (회귀계수, 오즈비, p-value)

```
## ❓ 질문

Q1. '나이' 변수의 회귀계수를 소수점 4자리까지 구하시오. (출력: 소수점 4자리)
Q2. '나이' 변수의 오즈비를 소수점 3자리까지 구하시오. (출력: 소수점 3자리)
Q3. '소득' 변수의 p-value를 소수점 4자리까지 구하시오. (출력: 소수점 4자리)
Q4. '방문횟수' 변수가 유의수준 0.05에서 유의한지 판단하시오. (출력: "유의" 또는 "유의하지 않음")
```

### 고급 질문 (예측 포함)

```
## ❓ 질문

Q1. '나이' 변수의 오즈비를 구하시오. (출력: 소수점 3자리)
Q2. '소득' 변수의 오즈비를 구하시오. (출력: 소수점 3자리)
Q3. 오즈비가 1보다 큰 변수의 개수를 구하시오. (출력: 정수)
Q4. 유의수준 0.05에서 유의한 변수의 개수를 구하시오. (출력: 정수)
Q5. 나이=30, 소득=4500, 방문횟수=6일 때 구매 확률을 구하시오. (출력: 소수점 3자리)
Q6. 오즈비 절대값이 가장 큰 변수명을 구하시오. (출력: "변수명")
```

---

## 🎯 힌트 템플릿

```markdown
## 힌트

### 필요한 라이브러리
- pandas
- numpy
- statsmodels.api as sm

### 주요 함수
1. 절편 추가: `sm.add_constant(X)` ← 반드시!
2. 모델 적합: `sm.Logit(y, X).fit()`
3. 회귀계수: `model.params['변수명']`
4. 오즈비: `np.exp(model.params['변수명'])`
5. p-value: `model.pvalues['변수명']`
6. 예측 확률: `model.predict(새로운X)` (새로운X에도 const 컬럼 필수)

### 판단 기준
- p-value < 0.05 → 유의함
- p-value ≥ 0.05 → 유의하지 않음
- 오즈비 > 1 → 양의 관계 (변수 증가 시 Y=1 확률 증가)
- 오즈비 < 1 → 음의 관계 (변수 증가 시 Y=1 확률 감소)

### 흔한 실수
❌ sm.add_constant() 누락 (절편이 0이 됨)
❌ Logit(X, y) 순서 (정답: Logit(y, X))
❌ 오즈비 계산 시 np.exp() 누락
❌ 종속변수가 문자열 ('구매', '비구매') → 0/1로 변환 필요
❌ model.params 대신 model.coef_ 사용 (sklearn 문법)
```

---

## 📝 정답 코드 템플릿

### 기본 템플릿 (회귀계수, 오즈비, p-value)

```python
import pandas as pd
import numpy as np
import statsmodels.api as sm

# 데이터 생성
df = pd.DataFrame({
    '고객ID': [f'C{i:03d}' for i in range(1, 41)],
    '나이': [25, 30, 35, 40, 28, 33, 38, 26, 31, 36,
             24, 29, 34, 39, 27, 32, 37, 25, 30, 35,
             23, 28, 33, 38, 26, 31, 36, 24, 29, 34,
             22, 27, 32, 37, 25, 30, 35, 23, 28, 33],
    '소득': [3500, 4200, 5000, 5500, 3800, 4500, 5200, 3600, 4300, 5100,
             3400, 4100, 4900, 5400, 3700, 4400, 5100, 3500, 4200, 5000,
             3300, 4000, 4800, 5300, 3600, 4300, 5000, 3400, 4100, 4900,
             3200, 3900, 4700, 5200, 3500, 4200, 4900, 3300, 4000, 4800],
    '방문횟수': [2, 5, 7, 10, 3, 6, 8, 2, 5, 7,
                 1, 4, 6, 9, 3, 5, 7, 2, 5, 7,
                 1, 4, 6, 9, 2, 5, 7, 1, 4, 6,
                 0, 3, 5, 8, 2, 5, 7, 1, 4, 6],
    '구매여부': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 1, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 0, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 0, 1, 1, 0, 1, 1, 0, 0, 1]
})

# X, y 분리
X = df[['나이', '소득', '방문횟수']]
y = df['구매여부']

# 절편 추가
X = sm.add_constant(X)

# Logit 모델 적합
model = sm.Logit(y, X).fit()

# Q1: 나이 회귀계수
print(round(model.params['나이'], 4))

# Q2: 나이 오즈비
print(round(np.exp(model.params['나이']), 3))

# Q3: 소득 p-value
print(round(model.pvalues['소득'], 4))

# Q4: 방문횟수 유의성
print("유의" if model.pvalues['방문횟수'] < 0.05 else "유의하지 않음")
```

### 고급 템플릿 (예측 포함)

```python
import pandas as pd
import numpy as np
import statsmodels.api as sm

# 데이터 생성 (위와 동일)
df = pd.DataFrame({
    '고객ID': [f'C{i:03d}' for i in range(1, 41)],
    '나이': [25, 30, 35, 40, 28, 33, 38, 26, 31, 36,
             24, 29, 34, 39, 27, 32, 37, 25, 30, 35,
             23, 28, 33, 38, 26, 31, 36, 24, 29, 34,
             22, 27, 32, 37, 25, 30, 35, 23, 28, 33],
    '소득': [3500, 4200, 5000, 5500, 3800, 4500, 5200, 3600, 4300, 5100,
             3400, 4100, 4900, 5400, 3700, 4400, 5100, 3500, 4200, 5000,
             3300, 4000, 4800, 5300, 3600, 4300, 5000, 3400, 4100, 4900,
             3200, 3900, 4700, 5200, 3500, 4200, 4900, 3300, 4000, 4800],
    '방문횟수': [2, 5, 7, 10, 3, 6, 8, 2, 5, 7,
                 1, 4, 6, 9, 3, 5, 7, 2, 5, 7,
                 1, 4, 6, 9, 2, 5, 7, 1, 4, 6,
                 0, 3, 5, 8, 2, 5, 7, 1, 4, 6],
    '구매여부': [0, 1, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 1, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 0, 1, 1, 0, 1, 1, 0, 1, 1,
                 0, 0, 1, 1, 0, 1, 1, 0, 0, 1]
})

# X, y 분리
X = df[['나이', '소득', '방문횟수']]
y = df['구매여부']

# 절편 추가
X = sm.add_constant(X)

# Logit 모델
model = sm.Logit(y, X).fit()

# Q1: 나이 오즈비
print(round(np.exp(model.params['나이']), 3))

# Q2: 소득 오즈비
print(round(np.exp(model.params['소득']), 3))

# Q3: 오즈비 > 1인 변수 개수 (const 제외)
odds_ratios = np.exp(model.params[1:])
count_gt_1 = sum(odds_ratios > 1)
print(count_gt_1)

# Q4: 유의한 변수 개수 (const 제외)
significant_count = sum(model.pvalues[1:] < 0.05)
print(significant_count)

# Q5: 예측 확률 (나이=30, 소득=4500, 방문횟수=6)
new_X = pd.DataFrame({
    'const': [1],
    '나이': [30],
    '소득': [4500],
    '방문횟수': [6]
})
prob = model.predict(new_X)
print(round(prob.values[0], 3))

# Q6: 오즈비 절대값이 가장 큰 변수 (const 제외)
odds_ratios = np.exp(model.params[1:])
abs_odds = (odds_ratios - 1).abs()  # 1에서 얼마나 멀리 떨어져 있는지
print(abs_odds.idxmax())
```

---

## 🔍 시나리오 예시

### 마케팅/전자상거래
"한 온라인 쇼핑몰에서 고객의 구매 여부를 예측하고자 합니다. 40명의 고객을 대상으로 나이, 연소득(만원), 월간 방문횟수와 구매 여부(0: 비구매, 1: 구매) 데이터를 수집했습니다. 로지스틱회귀분석을 통해 각 요인이 구매 확률에 미치는 영향을 분석하고, 신규 고객의 구매 확률을 예측하고자 합니다."

### 교육/입시
"한 대학교에서 입학시험 합격 여부를 예측하고자 합니다. 35명의 지원자를 대상으로 수능 점수, 내신 등급, 면접 점수와 합격 여부(0: 불합격, 1: 합격) 데이터를 조사했습니다. 각 요인이 합격 확률에 미치는 영향을 분석하고, 특정 점수를 받은 지원자의 합격 확률을 예측하고자 합니다."

### 의학/건강
"한 병원에서 당뇨병 발병 여부를 예측하고자 합니다. 45명의 환자를 대상으로 나이, BMI 지수, 혈당 수치와 당뇨병 진단 여부(0: 정상, 1: 당뇨) 데이터를 수집했습니다. 각 지표가 당뇨병 발병 확률에 미치는 영향을 분석하고, 특정 건강 상태를 가진 환자의 발병 확률을 예측하고자 합니다."

### 금융/신용평가
"한 은행에서 대출 상환 여부를 예측하고자 합니다. 40명의 대출 고객을 대상으로 연령, 연소득(만원), 신용점수와 상환 여부(0: 연체, 1: 정상상환) 데이터를 분석했습니다. 각 요인이 정상 상환 확률에 미치는 영향을 파악하고, 신규 대출 신청자의 상환 확률을 예측하고자 합니다."

---

## ⚠️ 주의사항

### 반드시 지킬 것
1. ✅ 리터럴 데이터만 사용 (np.random 금지)
2. ✅ 변수명은 한국어
3. ✅ 30-50개 샘플
4. ✅ "## ❓ 질문" 헤더 필수
5. ✅ Q1. Q2. Q3. Q4. Q5. 형식 사용
6. ✅ 종속변수는 이진 (0/1) + 독립변수 2-4개

### statsmodels Logit 필수 사항
- **sm.add_constant(X) 반드시 사용** (절편 추가)
- **Logit(y, X) 순서 준수** (y가 먼저)
- **오즈비 = np.exp(회귀계수)** 계산
- 예측 시 새 데이터에도 const 컬럼 필수

### 흔한 실수 방지
- ❌ **1)**, **2)** 형식 사용
- ❌ sm.add_constant() 누락
- ❌ Logit(X, y) 순서 잘못
- ❌ 정답 코드에서 `df = pd.DataFrame({...})` 생략
- ❌ sklearn의 LogisticRegression() 사용 (statsmodels Logit 사용)
- ❌ model.coef_ 사용 (model.params 사용)
- ❌ 오즈비 계산 시 np.exp() 누락

---

## 🚀 문제 생성 지침

위 모든 규칙을 따라, 다음 순서로 문제를 생성하세요:

1. **# [제목]** - 간결한 제목
2. **## 시나리오** - 2-3문장의 현실적 이진 분류 상황
3. **## 데이터 생성 코드** - 30-50행, 종속변수 1개(0/1) + 독립변수 2-4개, 리터럴 값으로만
4. **## ❓ 질문** - Q1~Q6 형식 (최소 4개)
5. **## 힌트** - 라이브러리, 함수, 주의사항
6. **## 정답 코드** - 완전한 실행 가능 코드 (데이터 생성 포함, sm.add_constant() 사용, np.exp() 사용)

지금 바로 문제를 생성하세요!
